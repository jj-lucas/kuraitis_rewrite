# Migration `20201128124322-add-relation-between-report-and-image`

This migration has been generated by Lucas Gabriel Salina D'Ovidio at 11/28/2020, 1:43:22 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
PRAGMA foreign_keys=OFF;
CREATE TABLE "new_Report" (
    "id" TEXT NOT NULL,
    "createdAt" DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "resolvedAt" DATETIME,
    "description" TEXT NOT NULL,
    "imageId" TEXT NOT NULL,

    FOREIGN KEY ("imageId") REFERENCES "Image"("id") ON DELETE CASCADE ON UPDATE CASCADE,
    PRIMARY KEY ("id")
);
INSERT INTO "new_Report" ("id", "createdAt", "resolvedAt", "description") SELECT "id", "createdAt", "resolvedAt", "description" FROM "Report";
DROP TABLE "Report";
ALTER TABLE "new_Report" RENAME TO "Report";
PRAGMA foreign_key_check;
PRAGMA foreign_keys=ON
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201120132659-added-model-matching-old-schema..20201128124322-add-relation-between-report-and-image
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
     provider = "sqlite"
-    url = "***"
+    url = "***"
 }
 generator client {
     provider = "prisma-client-js"
@@ -32,8 +32,9 @@
     product    Product?  @relation(fields: [productId], references: [id])
     Sku        Sku[]
     categoryId String?
     productId  String?
+    Report     Report[]
 }
 model Category {
     id             String    @id @default(cuid())
@@ -52,11 +53,11 @@
 model Report {
     id          String    @id @default(cuid())
     createdAt   DateTime  @default(now())
     resolvedAt  DateTime?
-    image       String
-    url         String
+    image       Image     @relation(fields: [imageId], references: [id])
     description String
+    imageId     String
 }
 model Product {
     id                 String     @id @default(cuid())
```


