# Migration `20210131123924-init-as-mysql-db`

This migration has been generated by Lucas Gabriel Salina D'Ovidio at 1/31/2021, 1:39:24 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE `Permission` (
`id` varchar(191)  NOT NULL ,
`name` varchar(191)  NOT NULL ,
UNIQUE INDEX `Permission.name_unique`(`name`),
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `User` (
`id` varchar(191)  NOT NULL ,
`name` varchar(191)  NOT NULL ,
`email` varchar(191)  NOT NULL ,
`password` varchar(191)  NOT NULL ,
`resetToken` varchar(191)  ,
`resetTokenExpiry` decimal(65,30)  ,
UNIQUE INDEX `User.email_unique`(`email`),
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `ProductImage` (
`id` varchar(191)  NOT NULL ,
`mainUrl` varchar(191)  NOT NULL ,
`adminUrl` varchar(191)  NOT NULL ,
`galleryUrl` varchar(191)  NOT NULL ,
`cartUrl` varchar(191)  NOT NULL ,
`thumbUrl` varchar(191)  NOT NULL ,
`sorting` int  ,
`productId` varchar(191)  ,
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `CategoryImage` (
`id` varchar(191)  NOT NULL ,
`thumbUrl` varchar(191)  NOT NULL ,
`adminUrl` varchar(191)  NOT NULL ,
`sorting` int  ,
`categoryId` varchar(191)  ,
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `Category` (
`id` varchar(191)  NOT NULL ,
`sorting` int  ,
`published` boolean  NOT NULL DEFAULT false,
`slug_da` varchar(191)  ,
`slug_en` varchar(191)  ,
`name_da` varchar(191)  ,
`name_en` varchar(191)  ,
`description_da` varchar(191)  ,
`description_en` varchar(191)  ,
UNIQUE INDEX `Category.slug_da_unique`(`slug_da`),
UNIQUE INDEX `Category.slug_en_unique`(`slug_en`),
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `Report` (
`id` varchar(191)  NOT NULL ,
`createdAt` datetime(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
`resolvedAt` datetime(3)  ,
`imageUrl` varchar(191)  NOT NULL ,
`url` varchar(191)  NOT NULL ,
`description` varchar(191)  NOT NULL ,
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `Product` (
`id` varchar(191)  NOT NULL ,
`code` varchar(191)  ,
`customizable` boolean  NOT NULL DEFAULT true,
`hasMultiplePrices` boolean  NOT NULL DEFAULT false,
`sorting` int  ,
`published` boolean  NOT NULL DEFAULT false,
`selectedAttributes` varchar(191)  ,
`slug_da` varchar(191)  ,
`slug_en` varchar(191)  ,
`name_da` varchar(191)  ,
`name_en` varchar(191)  ,
`description_da` varchar(191)  ,
`description_en` varchar(191)  ,
`priceId` varchar(191)  ,
UNIQUE INDEX `Product.code_unique`(`code`),
UNIQUE INDEX `Product.slug_da_unique`(`slug_da`),
UNIQUE INDEX `Product.slug_en_unique`(`slug_en`),
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `Sku` (
`id` varchar(191)  NOT NULL ,
`sku` varchar(191)  NOT NULL ,
`productId` varchar(191)  NOT NULL ,
`priceId` varchar(191)  ,
`imageId` varchar(191)  ,
`stock` int  NOT NULL DEFAULT 0,
UNIQUE INDEX `Sku.sku_unique`(`sku`),
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `CartSku` (
`id` varchar(191)  NOT NULL ,
`skuId` varchar(191)  NOT NULL ,
`cartId` varchar(191)  NOT NULL ,
`customization` varchar(191)  ,
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `Attribute` (
`id` varchar(191)  NOT NULL ,
`name` varchar(191)  NOT NULL ,
`options` varchar(191)  NOT NULL ,
`position` int  NOT NULL ,
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `Price` (
`id` varchar(191)  NOT NULL ,
`DKK` int  NOT NULL ,
`USD` int  NOT NULL ,
`EUR` int  NOT NULL ,
`GBP` int  NOT NULL ,
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `Cart` (
`id` varchar(191)  NOT NULL ,
`createdAt` datetime(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `ShippingProfile` (
`id` varchar(191)  NOT NULL ,
`code` varchar(191)  NOT NULL ,
`priceId` varchar(191)  NOT NULL ,
UNIQUE INDEX `ShippingProfile.code_unique`(`code`),
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `PurchasedSku` (
`id` varchar(191)  NOT NULL ,
`code` varchar(191)  NOT NULL ,
`name` varchar(191)  NOT NULL ,
`price` int  NOT NULL ,
`currency` varchar(191)  NOT NULL ,
`image` varchar(191)  NOT NULL ,
`variationInfo` varchar(191)  NOT NULL ,
`orderId` varchar(191)  ,
`customization` varchar(191)  ,
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `Order` (
`number` int  NOT NULL  AUTO_INCREMENT,
`id` varchar(191)  NOT NULL ,
`createdAt` datetime(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
`shippedAt` datetime(3)  ,
`shipping` varchar(191)  NOT NULL ,
`shippingCosts` varchar(191)  NOT NULL ,
`total` int  NOT NULL ,
`currency` varchar(191)  NOT NULL ,
`charge` varchar(191)  NOT NULL ,
`archived` boolean  NOT NULL DEFAULT false,
`trackingCode` varchar(191)  ,
`customerId` varchar(191)  NOT NULL ,
`locale` varchar(191)  NOT NULL ,
`comment` varchar(191)  ,
UNIQUE INDEX `Order.id_unique`(`id`),
PRIMARY KEY (`number`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `Customer` (
`id` varchar(191)  NOT NULL ,
`createdAt` datetime(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
`email` varchar(191)  NOT NULL ,
`name` varchar(191)  NOT NULL ,
`address` varchar(191)  NOT NULL ,
`address2` varchar(191)  ,
`city` varchar(191)  NOT NULL ,
`zip` varchar(191)  NOT NULL ,
`country` varchar(191)  NOT NULL ,
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `_PermissionToUser` (
`A` varchar(191)  NOT NULL ,
`B` varchar(191)  NOT NULL ,
UNIQUE INDEX `_PermissionToUser_AB_unique`(`A`,
`B`),
INDEX `_PermissionToUser_B_index`(`B`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `_CategoryToProduct` (
`A` varchar(191)  NOT NULL ,
`B` varchar(191)  NOT NULL ,
UNIQUE INDEX `_CategoryToProduct_AB_unique`(`A`,
`B`),
INDEX `_CategoryToProduct_B_index`(`B`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

ALTER TABLE `ProductImage` ADD FOREIGN KEY (`productId`) REFERENCES `Product`(`id`) ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE `CategoryImage` ADD FOREIGN KEY (`categoryId`) REFERENCES `Category`(`id`) ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE `Product` ADD FOREIGN KEY (`priceId`) REFERENCES `Price`(`id`) ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE `Sku` ADD FOREIGN KEY (`productId`) REFERENCES `Product`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `Sku` ADD FOREIGN KEY (`priceId`) REFERENCES `Price`(`id`) ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE `Sku` ADD FOREIGN KEY (`imageId`) REFERENCES `ProductImage`(`id`) ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE `CartSku` ADD FOREIGN KEY (`skuId`) REFERENCES `Sku`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `CartSku` ADD FOREIGN KEY (`cartId`) REFERENCES `Cart`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `ShippingProfile` ADD FOREIGN KEY (`priceId`) REFERENCES `Price`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `PurchasedSku` ADD FOREIGN KEY (`orderId`) REFERENCES `Order`(`id`) ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE `Order` ADD FOREIGN KEY (`customerId`) REFERENCES `Customer`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `_PermissionToUser` ADD FOREIGN KEY (`A`) REFERENCES `Permission`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `_PermissionToUser` ADD FOREIGN KEY (`B`) REFERENCES `User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `_CategoryToProduct` ADD FOREIGN KEY (`A`) REFERENCES `Category`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `_CategoryToProduct` ADD FOREIGN KEY (`B`) REFERENCES `Product`(`id`) ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20210131123924-init-as-mysql-db
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,188 @@
+datasource db {
+    provider = "mysql"
+    url = "***"
+}
+
+generator client {
+    provider = "prisma-client-js"
+}
+
+model Permission {
+    id    String @id @default(cuid())
+    name  String @unique
+    users User[]
+}
+
+model User {
+    id               String       @id @default(cuid())
+    name             String
+    email            String       @unique
+    password         String
+    resetToken       String?
+    resetTokenExpiry Float?
+    permissions      Permission[]
+}
+
+model ProductImage {
+    id         String   @id @default(cuid())
+    mainUrl    String
+    adminUrl   String
+    galleryUrl String
+    cartUrl    String
+    thumbUrl   String
+    sorting    Int?
+    product    Product? @relation(fields: [productId], references: [id])
+    productId  String?
+    sku        Sku[]
+}
+
+model CategoryImage {
+    id         String    @id @default(cuid())
+    thumbUrl   String
+    adminUrl   String
+    sorting    Int?
+    category   Category? @relation(fields: [categoryId], references: [id])
+    categoryId String?
+}
+
+model Category {
+    id             String          @id @default(cuid())
+    sorting        Int?
+    published      Boolean         @default(false)
+    products       Product[]
+    images         CategoryImage[]
+    slug_da        String?         @unique
+    slug_en        String?         @unique
+    name_da        String?
+    name_en        String?
+    description_da String?
+    description_en String?
+}
+
+model Report {
+    id          String    @id @default(cuid())
+    createdAt   DateTime  @default(now())
+    resolvedAt  DateTime?
+    imageUrl    String
+    url         String
+    description String
+}
+
+model Product {
+    id                 String         @id @default(cuid())
+    code               String?        @unique
+    customizable       Boolean        @default(true)
+    price              Price?         @relation(fields: [priceId], references: [id])
+    hasMultiplePrices  Boolean        @default(false)
+    sorting            Int?
+    published          Boolean        @default(false)
+    categories         Category[]
+    images             ProductImage[]
+    skus               Sku[]
+    selectedAttributes String?
+    slug_da            String?        @unique
+    slug_en            String?        @unique
+    name_da            String?
+    name_en            String?
+    description_da     String?
+    description_en     String?
+    priceId            String?
+}
+
+model Sku {
+    id        String        @id @default(cuid())
+    sku       String        @unique
+    product   Product       @relation(fields: [productId], references: [id])
+    price     Price?        @relation(fields: [priceId], references: [id])
+    image     ProductImage? @relation(fields: [imageId], references: [id])
+    productId String
+    priceId   String?
+    imageId   String?
+    stock     Int           @default(0)
+    CartSku   CartSku[]
+}
+
+model CartSku {
+    id            String  @id @default(cuid())
+    sku           Sku     @relation(fields: [skuId], references: [id])
+    cart          Cart    @relation(fields: [cartId], references: [id])
+    skuId         String
+    cartId        String
+    customization String?
+}
+
+model Attribute {
+    id       String @id @default(cuid())
+    name     String
+    options  String
+    position Int
+}
+
+model Price {
+    id              String            @id @default(cuid())
+    DKK             Int
+    USD             Int
+    EUR             Int
+    GBP             Int
+    product         Product[]
+    sku             Sku[]
+    shippingProfile ShippingProfile[]
+}
+
+model Cart {
+    id        String    @id @default(cuid())
+    createdAt DateTime  @default(now())
+    cartSkus  CartSku[]
+}
+
+model ShippingProfile {
+    id      String @id @default(cuid())
+    code    String @unique
+    price   Price  @relation(fields: [priceId], references: [id])
+    priceId String
+}
+
+model PurchasedSku {
+    id            String  @id @default(cuid())
+    code          String
+    name          String
+    price         Int
+    currency      String
+    image         String
+    variationInfo String
+    order         Order?  @relation(fields: [orderId], references: [id])
+    orderId       String?
+    customization String?
+}
+
+model Order {
+    number        Int            @id @default(autoincrement())
+    id            String         @unique @default(cuid())
+    createdAt     DateTime       @default(now())
+    shippedAt     DateTime?
+    items         PurchasedSku[]
+    shipping      String
+    shippingCosts String
+    total         Int
+    currency      String
+    charge        String
+    customer      Customer       @relation(fields: [customerId], references: [id])
+    archived      Boolean        @default(false)
+    trackingCode  String?
+    customerId    String
+    locale        String
+    comment       String?
+}
+
+model Customer {
+    id        String   @id @default(cuid())
+    createdAt DateTime @default(now())
+    email     String
+    name      String
+    address   String
+    address2  String?
+    city      String
+    zip       String
+    country   String
+    orders    Order[]
+}
```


